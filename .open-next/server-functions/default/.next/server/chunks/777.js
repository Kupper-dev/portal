"use strict";exports.id=777,exports.ids=[777],exports.modules={171:(a,b,c)=>{c.r(b),c.d(b,{decode:()=>f,encode:()=>g});var d=c(37432),e=c(46379);function f(a){if(Uint8Array.fromBase64)return Uint8Array.fromBase64("string"==typeof a?a:d.D0.decode(a),{alphabet:"base64url"});let b=a;b instanceof Uint8Array&&(b=d.D0.decode(b)),b=b.replace(/-/g,"+").replace(/_/g,"/");try{return(0,e.y)(b)}catch{throw TypeError("The input to be decoded is not correctly encoded.")}}function g(a){let b=a;return("string"==typeof b&&(b=d.Rd.encode(b)),Uint8Array.prototype.toBase64)?b.toBase64({alphabet:"base64url",omitPadding:!0}):(0,e.W)(b).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}},1519:(a,b,c)=>{c.d(b,{L:()=>g,o:()=>h});var d=c(27701);function e(a,b){if(a.algorithm.length!==parseInt(b.slice(1,4),10))throw TypeError(`Invalid key size for alg: ${b}`)}function f(a,b,c){return a instanceof Uint8Array?crypto.subtle.importKey("raw",a,"AES-KW",!0,[c]):((0,d.$)(a,b,c),a)}async function g(a,b,c){let d=await f(b,a,"wrapKey");e(d,a);let g=await crypto.subtle.importKey("raw",c,{hash:"SHA-256",name:"HMAC"},!0,["sign"]);return new Uint8Array(await crypto.subtle.wrapKey("raw",g,d,"AES-KW"))}async function h(a,b,c){let d=await f(b,a,"unwrapKey");e(d,a);let g=await crypto.subtle.unwrapKey("raw",c,d,"AES-KW",{hash:"SHA-256",name:"HMAC"},!0,["sign"]);return new Uint8Array(await crypto.subtle.exportKey("raw",g))}},1911:(a,b,c)=>{c.d(b,{F:()=>d});function d(a,b){if(void 0!==b&&(!Array.isArray(b)||b.some(a=>"string"!=typeof a)))throw TypeError(`"${a}" option must be an array of strings`);if(b)return new Set(b)}},3938:(a,b,c)=>{c.d(b,{j:()=>n});var d=c(171),e=c(81815),f=c(54095),g=c(68049),h=c(33164),i=c(66719),j=c(37432),k=c(17969),l=c(80801),m=c(80053);class n{#a;#b;#c;#d;#e;#f;#g;#h;constructor(a){if(!(a instanceof Uint8Array))throw TypeError("plaintext must be an instance of Uint8Array");this.#a=a}setKeyManagementParameters(a){if(this.#h)throw TypeError("setKeyManagementParameters can only be called once");return this.#h=a,this}setProtectedHeader(a){if(this.#b)throw TypeError("setProtectedHeader can only be called once");return this.#b=a,this}setSharedUnprotectedHeader(a){if(this.#c)throw TypeError("setSharedUnprotectedHeader can only be called once");return this.#c=a,this}setUnprotectedHeader(a){if(this.#d)throw TypeError("setUnprotectedHeader can only be called once");return this.#d=a,this}setAdditionalAuthenticatedData(a){return this.#e=a,this}setContentEncryptionKey(a){if(this.#f)throw TypeError("setContentEncryptionKey can only be called once");return this.#f=a,this}setInitializationVector(a){if(this.#g)throw TypeError("setInitializationVector can only be called once");return this.#g=a,this}async encrypt(a,b){let c,n,o,p,q,r;if(!this.#b&&!this.#d&&!this.#c)throw new h.JWEInvalid("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!(0,i.f)(this.#b,this.#d,this.#c))throw new h.JWEInvalid("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let s={...this.#b,...this.#d,...this.#c};if((0,k.n)(h.JWEInvalid,new Map,b?.crit,this.#b,s),void 0!==s.zip)throw new h.JOSENotSupported('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');let{alg:t,enc:u}=s;if("string"!=typeof t||!t)throw new h.JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("string"!=typeof u||!u)throw new h.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if(this.#f&&("dir"===t||"ECDH-ES"===t))throw TypeError(`setContentEncryptionKey cannot be called with JWE "alg" (Algorithm) Header ${t}`);(0,m.y)("dir"===t?u:t,a,"encrypt");{let d,f=await (0,l.l)(a,t);({cek:n,encryptedKey:c,parameters:d}=await (0,g.s)(t,u,f,this.#f,this.#h)),d&&(b&&e.o in b?this.#d?this.#d={...this.#d,...d}:this.setUnprotectedHeader(d):this.#b?this.#b={...this.#b,...d}:this.setProtectedHeader(d))}if(this.#b?(p=(0,d.encode)(JSON.stringify(this.#b)),q=(0,j.lF)(p)):(p="",q=new Uint8Array),this.#e){r=(0,d.encode)(this.#e);let a=(0,j.lF)(r);o=(0,j.xW)(q,(0,j.lF)("."),a)}else o=q;let{ciphertext:v,tag:w,iv:x}=await (0,f.w)(u,this.#a,n,this.#g,o),y={ciphertext:(0,d.encode)(v)};return x&&(y.iv=(0,d.encode)(x)),w&&(y.tag=(0,d.encode)(w)),c&&(y.encrypted_key=(0,d.encode)(c)),r&&(y.aad=r),this.#b&&(y.protected=p),this.#c&&(y.unprotected=this.#c),this.#d&&(y.header=this.#d),y}}},4931:(a,b,c)=>{c.d(b,{D:()=>f,u:()=>e});var d=c(33164);function e(a){switch(a){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new d.JOSENotSupported(`Unsupported JWE Algorithm: ${a}`)}}let f=a=>crypto.getRandomValues(new Uint8Array(e(a)>>3))},5716:(a,b,c)=>{c.d(b,{d:()=>g});var d=c(91161),e=c(33164),f=c(37432);async function g(a,b,c){if(a instanceof Uint8Array&&(a=f.D0.decode(a)),"string"!=typeof a)throw new e.JWEInvalid("Compact JWE must be a string or Uint8Array");let{0:g,1:h,2:i,3:j,4:k,length:l}=a.split(".");if(5!==l)throw new e.JWEInvalid("Invalid Compact JWE");let m=await (0,d.d)({ciphertext:j,iv:i||void 0,protected:g,tag:k||void 0,encrypted_key:h||void 0},b,c),n={plaintext:m.plaintext,protectedHeader:m.protectedHeader};return"function"==typeof b?{...n,key:m.key}:n}},7448:(a,b,c)=>{c.d(b,{cE:()=>m,k6:()=>l});var d=c(33164),e=c(37432),f=c(32712);let g=a=>Math.floor(a.getTime()/1e3),h=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i;function i(a){let b,c=h.exec(a);if(!c||c[4]&&c[1])throw TypeError("Invalid time period format");let d=parseFloat(c[2]);switch(c[3].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":b=Math.round(d);break;case"minute":case"minutes":case"min":case"mins":case"m":b=Math.round(60*d);break;case"hour":case"hours":case"hr":case"hrs":case"h":b=Math.round(3600*d);break;case"day":case"days":case"d":b=Math.round(86400*d);break;case"week":case"weeks":case"w":b=Math.round(604800*d);break;default:b=Math.round(0x1e187e0*d)}return"-"===c[1]||"ago"===c[4]?-b:b}function j(a,b){if(!Number.isFinite(b))throw TypeError(`Invalid ${a} input`);return b}let k=a=>a.includes("/")?a.toLowerCase():`application/${a.toLowerCase()}`;function l(a,b,c={}){var h,j;let m,n;try{m=JSON.parse(e.D0.decode(b))}catch{}if(!(0,f.G)(m))throw new d.JWTInvalid("JWT Claims Set must be a top-level JSON object");let{typ:o}=c;if(o&&("string"!=typeof a.typ||k(a.typ)!==k(o)))throw new d.JWTClaimValidationFailed('unexpected "typ" JWT header value',m,"typ","check_failed");let{requiredClaims:p=[],issuer:q,subject:r,audience:s,maxTokenAge:t}=c,u=[...p];for(let a of(void 0!==t&&u.push("iat"),void 0!==s&&u.push("aud"),void 0!==r&&u.push("sub"),void 0!==q&&u.push("iss"),new Set(u.reverse())))if(!(a in m))throw new d.JWTClaimValidationFailed(`missing required "${a}" claim`,m,a,"missing");if(q&&!(Array.isArray(q)?q:[q]).includes(m.iss))throw new d.JWTClaimValidationFailed('unexpected "iss" claim value',m,"iss","check_failed");if(r&&m.sub!==r)throw new d.JWTClaimValidationFailed('unexpected "sub" claim value',m,"sub","check_failed");if(s&&(h=m.aud,j="string"==typeof s?[s]:s,"string"==typeof h?!j.includes(h):!(Array.isArray(h)&&j.some(Set.prototype.has.bind(new Set(h))))))throw new d.JWTClaimValidationFailed('unexpected "aud" claim value',m,"aud","check_failed");switch(typeof c.clockTolerance){case"string":n=i(c.clockTolerance);break;case"number":n=c.clockTolerance;break;case"undefined":n=0;break;default:throw TypeError("Invalid clockTolerance option type")}let{currentDate:v}=c,w=g(v||new Date);if((void 0!==m.iat||t)&&"number"!=typeof m.iat)throw new d.JWTClaimValidationFailed('"iat" claim must be a number',m,"iat","invalid");if(void 0!==m.nbf){if("number"!=typeof m.nbf)throw new d.JWTClaimValidationFailed('"nbf" claim must be a number',m,"nbf","invalid");if(m.nbf>w+n)throw new d.JWTClaimValidationFailed('"nbf" claim timestamp check failed',m,"nbf","check_failed")}if(void 0!==m.exp){if("number"!=typeof m.exp)throw new d.JWTClaimValidationFailed('"exp" claim must be a number',m,"exp","invalid");if(m.exp<=w-n)throw new d.JWTExpired('"exp" claim timestamp check failed',m,"exp","check_failed")}if(t){let a=w-m.iat;if(a-n>("number"==typeof t?t:i(t)))throw new d.JWTExpired('"iat" claim timestamp check failed (too far in the past)',m,"iat","check_failed");if(a<0-n)throw new d.JWTClaimValidationFailed('"iat" claim timestamp check failed (it should be in the past)',m,"iat","check_failed")}return m}class m{#i;constructor(a){if(!(0,f.G)(a))throw TypeError("JWT Claims Set MUST be an object");this.#i=structuredClone(a)}data(){return e.Rd.encode(JSON.stringify(this.#i))}get iss(){return this.#i.iss}set iss(a){this.#i.iss=a}get sub(){return this.#i.sub}set sub(a){this.#i.sub=a}get aud(){return this.#i.aud}set aud(a){this.#i.aud=a}set jti(a){this.#i.jti=a}set nbf(a){"number"==typeof a?this.#i.nbf=j("setNotBefore",a):a instanceof Date?this.#i.nbf=j("setNotBefore",g(a)):this.#i.nbf=g(new Date)+i(a)}set exp(a){"number"==typeof a?this.#i.exp=j("setExpirationTime",a):a instanceof Date?this.#i.exp=j("setExpirationTime",g(a)):this.#i.exp=g(new Date)+i(a)}set iat(a){void 0===a?this.#i.iat=g(new Date):a instanceof Date?this.#i.iat=j("setIssuedAt",g(a)):"string"==typeof a?this.#i.iat=j("setIssuedAt",g(new Date)+i(a)):this.#i.iat=j("setIssuedAt",a)}}},12781:(a,b,c)=>{c.d(b,{L:()=>f});var d=c(41200),e=c(7448);class f{#f;#g;#h;#b;#j;#k;#l;#m;constructor(a={}){this.#m=new e.cE(a)}setIssuer(a){return this.#m.iss=a,this}setSubject(a){return this.#m.sub=a,this}setAudience(a){return this.#m.aud=a,this}setJti(a){return this.#m.jti=a,this}setNotBefore(a){return this.#m.nbf=a,this}setExpirationTime(a){return this.#m.exp=a,this}setIssuedAt(a){return this.#m.iat=a,this}setProtectedHeader(a){if(this.#b)throw TypeError("setProtectedHeader can only be called once");return this.#b=a,this}setKeyManagementParameters(a){if(this.#h)throw TypeError("setKeyManagementParameters can only be called once");return this.#h=a,this}setContentEncryptionKey(a){if(this.#f)throw TypeError("setContentEncryptionKey can only be called once");return this.#f=a,this}setInitializationVector(a){if(this.#g)throw TypeError("setInitializationVector can only be called once");return this.#g=a,this}replicateIssuerAsHeader(){return this.#j=!0,this}replicateSubjectAsHeader(){return this.#k=!0,this}replicateAudienceAsHeader(){return this.#l=!0,this}async encrypt(a,b){let c=new d.j(this.#m.data());return this.#b&&(this.#j||this.#k||this.#l)&&(this.#b={...this.#b,iss:this.#j?this.#m.iss:void 0,sub:this.#k?this.#m.sub:void 0,aud:this.#l?this.#m.aud:void 0}),c.setProtectedHeader(this.#b),this.#g&&c.setInitializationVector(this.#g),this.#f&&c.setContentEncryptionKey(this.#f),this.#h&&c.setKeyManagementParameters(this.#h),c.encrypt(a,b)}}},17969:(a,b,c)=>{c.d(b,{n:()=>e});var d=c(33164);function e(a,b,c,e,f){let g;if(void 0!==f.crit&&e?.crit===void 0)throw new a('"crit" (Critical) Header Parameter MUST be integrity protected');if(!e||void 0===e.crit)return new Set;if(!Array.isArray(e.crit)||0===e.crit.length||e.crit.some(a=>"string"!=typeof a||0===a.length))throw new a('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');for(let h of(g=void 0!==c?new Map([...Object.entries(c),...b.entries()]):b,e.crit)){if(!g.has(h))throw new d.JOSENotSupported(`Extension Header Parameter "${h}" is not recognized`);if(void 0===f[h])throw new a(`Extension Header Parameter "${h}" is missing`);if(g.get(h)&&void 0===e[h])throw new a(`Extension Header Parameter "${h}" MUST be integrity protected`)}return new Set(e.crit)}},27701:(a,b,c)=>{c.d(b,{$:()=>h,Y:()=>g});let d=(a,b="algorithm.name")=>TypeError(`CryptoKey does not support this operation, its ${b} must be ${a}`);function e(a){return parseInt(a.name.slice(4),10)}function f(a,b){if(b&&!a.usages.includes(b))throw TypeError(`CryptoKey does not support this operation, its usages must include ${b}.`)}function g(a,b,c){switch(b){case"HS256":case"HS384":case"HS512":{if("HMAC"!==a.algorithm.name)throw d("HMAC");let c=parseInt(b.slice(2),10);if(e(a.algorithm.hash)!==c)throw d(`SHA-${c}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if("RSASSA-PKCS1-v1_5"!==a.algorithm.name)throw d("RSASSA-PKCS1-v1_5");let c=parseInt(b.slice(2),10);if(e(a.algorithm.hash)!==c)throw d(`SHA-${c}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if("RSA-PSS"!==a.algorithm.name)throw d("RSA-PSS");let c=parseInt(b.slice(2),10);if(e(a.algorithm.hash)!==c)throw d(`SHA-${c}`,"algorithm.hash");break}case"Ed25519":case"EdDSA":if("Ed25519"!==a.algorithm.name)throw d("Ed25519");break;case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":let g;if(g=a.algorithm,g.name!==b)throw d(b);break;case"ES256":case"ES384":case"ES512":{if("ECDSA"!==a.algorithm.name)throw d("ECDSA");let c=function(a){switch(a){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw Error("unreachable")}}(b);if(a.algorithm.namedCurve!==c)throw d(c,"algorithm.namedCurve");break}default:throw TypeError("CryptoKey does not support this operation")}f(a,c)}function h(a,b,c){switch(b){case"A128GCM":case"A192GCM":case"A256GCM":{if("AES-GCM"!==a.algorithm.name)throw d("AES-GCM");let c=parseInt(b.slice(1,4),10);if(a.algorithm.length!==c)throw d(c,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if("AES-KW"!==a.algorithm.name)throw d("AES-KW");let c=parseInt(b.slice(1,4),10);if(a.algorithm.length!==c)throw d(c,"algorithm.length");break}case"ECDH":switch(a.algorithm.name){case"ECDH":case"X25519":break;default:throw d("ECDH or X25519")}break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if("PBKDF2"!==a.algorithm.name)throw d("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if("RSA-OAEP"!==a.algorithm.name)throw d("RSA-OAEP");let c=parseInt(b.slice(9),10)||1;if(e(a.algorithm.hash)!==c)throw d(`SHA-${c}`,"algorithm.hash");break}default:throw TypeError("CryptoKey does not support this operation")}f(a,c)}},32712:(a,b,c)=>{c.d(b,{G:()=>d});function d(a){if("object"!=typeof a||null===a||"[object Object]"!==Object.prototype.toString.call(a))return!1;if(null===Object.getPrototypeOf(a))return!0;let b=a;for(;null!==Object.getPrototypeOf(b);)b=Object.getPrototypeOf(b);return Object.getPrototypeOf(a)===b}},33164:(a,b,c)=>{c.r(b),c.d(b,{JOSEAlgNotAllowed:()=>g,JOSEError:()=>d,JOSENotSupported:()=>h,JWEDecryptionFailed:()=>i,JWEInvalid:()=>j,JWKInvalid:()=>m,JWKSInvalid:()=>n,JWKSMultipleMatchingKeys:()=>p,JWKSNoMatchingKey:()=>o,JWKSTimeout:()=>q,JWSInvalid:()=>k,JWSSignatureVerificationFailed:()=>r,JWTClaimValidationFailed:()=>e,JWTExpired:()=>f,JWTInvalid:()=>l});class d extends Error{static code="ERR_JOSE_GENERIC";code="ERR_JOSE_GENERIC";constructor(a,b){super(a,b),this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}class e extends d{static code="ERR_JWT_CLAIM_VALIDATION_FAILED";code="ERR_JWT_CLAIM_VALIDATION_FAILED";claim;reason;payload;constructor(a,b,c="unspecified",d="unspecified"){super(a,{cause:{claim:c,reason:d,payload:b}}),this.claim=c,this.reason=d,this.payload=b}}class f extends d{static code="ERR_JWT_EXPIRED";code="ERR_JWT_EXPIRED";claim;reason;payload;constructor(a,b,c="unspecified",d="unspecified"){super(a,{cause:{claim:c,reason:d,payload:b}}),this.claim=c,this.reason=d,this.payload=b}}class g extends d{static code="ERR_JOSE_ALG_NOT_ALLOWED";code="ERR_JOSE_ALG_NOT_ALLOWED"}class h extends d{static code="ERR_JOSE_NOT_SUPPORTED";code="ERR_JOSE_NOT_SUPPORTED"}class i extends d{static code="ERR_JWE_DECRYPTION_FAILED";code="ERR_JWE_DECRYPTION_FAILED";constructor(a="decryption operation failed",b){super(a,b)}}class j extends d{static code="ERR_JWE_INVALID";code="ERR_JWE_INVALID"}class k extends d{static code="ERR_JWS_INVALID";code="ERR_JWS_INVALID"}class l extends d{static code="ERR_JWT_INVALID";code="ERR_JWT_INVALID"}class m extends d{static code="ERR_JWK_INVALID";code="ERR_JWK_INVALID"}class n extends d{static code="ERR_JWKS_INVALID";code="ERR_JWKS_INVALID"}class o extends d{static code="ERR_JWKS_NO_MATCHING_KEY";code="ERR_JWKS_NO_MATCHING_KEY";constructor(a="no applicable key found in the JSON Web Key Set",b){super(a,b)}}class p extends d{[Symbol.asyncIterator];static code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";constructor(a="multiple matching keys found in the JSON Web Key Set",b){super(a,b)}}class q extends d{static code="ERR_JWKS_TIMEOUT";code="ERR_JWKS_TIMEOUT";constructor(a="request timed out",b){super(a,b)}}class r extends d{static code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED";code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED";constructor(a="signature verification failed",b){super(a,b)}}},33656:(a,b,c)=>{c.d(b,{H:()=>i,T:()=>j});var d=c(37432),e=c(27701),f=c(72892);function g(a){return(0,d.xW)((0,d.VS)(a.length),a)}async function h(a,b,c){let e=b>>3,g=Math.ceil(e/32),h=new Uint8Array(32*g);for(let b=1;b<=g;b++){let e=new Uint8Array(4+a.length+c.length);e.set((0,d.VS)(b),0),e.set(a,4),e.set(c,4+a.length);let g=await (0,f.b)("sha256",e);h.set(g,(b-1)*32)}return h.slice(0,e)}async function i(a,b,c,f,j=new Uint8Array,k=new Uint8Array){var l;(0,e.$)(a,"ECDH"),(0,e.$)(b,"ECDH","deriveBits");let m=g((0,d.lF)(c)),n=g(j),o=g(k),p=(0,d.VS)(f),q=new Uint8Array,r=(0,d.xW)(m,n,o,p,q);return h(new Uint8Array(await crypto.subtle.deriveBits({name:a.algorithm.name,public:a},b,"X25519"===(l=a).algorithm.name?256:Math.ceil(parseInt(l.algorithm.namedCurve.slice(-3),10)/8)<<3)),f,r)}function j(a){switch(a.algorithm.namedCurve){case"P-256":case"P-384":case"P-521":return!0;default:return"X25519"===a.algorithm.name}}},33999:(a,b,c)=>{c.d(b,{M3:()=>g,W2:()=>f,ll:()=>e,t9:()=>h});var d=c(32712);let e=a=>(0,d.G)(a)&&"string"==typeof a.kty,f=a=>"oct"!==a.kty&&("AKP"===a.kty&&"string"==typeof a.priv||"string"==typeof a.d),g=a=>"oct"!==a.kty&&void 0===a.d&&void 0===a.priv,h=a=>"oct"===a.kty&&"string"==typeof a.k},34525:(a,b,c)=>{c.d(b,{S:()=>f});var d=c(33164),e=c(67263);function f(a,b){if(b.length<<3!==(0,e.a)(a))throw new d.JWEInvalid("Invalid Initialization Vector length")}},37432:(a,b,c)=>{c.d(b,{D0:()=>e,Rd:()=>d,VS:()=>i,lF:()=>j,mx:()=>h,xW:()=>f});let d=new TextEncoder,e=new TextDecoder;function f(...a){let b=new Uint8Array(a.reduce((a,{length:b})=>a+b,0)),c=0;for(let d of a)b.set(d,c),c+=d.length;return b}function g(a,b,c){if(b<0||b>=0x100000000)throw RangeError(`value must be >= 0 and <= ${0x100000000-1}. Received ${b}`);a.set([b>>>24,b>>>16,b>>>8,255&b],c)}function h(a){let b=Math.floor(a/0x100000000),c=new Uint8Array(8);return g(c,b,0),g(c,a%0x100000000,4),c}function i(a){let b=new Uint8Array(4);return g(b,a),b}function j(a){let b=new Uint8Array(a.length);for(let c=0;c<a.length;c++){let d=a.charCodeAt(c);if(d>127)throw TypeError("non-ASCII string encountered in encode()");b[c]=d}return b}},39976:(a,b,c)=>{c.d(b,{L:()=>j,o:()=>k});var d=c(171),e=c(1519),f=c(27701),g=c(37432),h=c(33164);async function i(a,b,c,d){if(!(a instanceof Uint8Array)||a.length<8)throw new h.JWEInvalid("PBES2 Salt Input must be 8 or more octets");let e=(0,g.xW)((0,g.lF)(b),Uint8Array.of(0),a),i=parseInt(b.slice(13,16),10),j={hash:`SHA-${b.slice(8,11)}`,iterations:c,name:"PBKDF2",salt:e},k=await (d instanceof Uint8Array?crypto.subtle.importKey("raw",d,"PBKDF2",!1,["deriveBits"]):((0,f.$)(d,b,"deriveBits"),d));return new Uint8Array(await crypto.subtle.deriveBits(j,k,i))}async function j(a,b,c,f=2048,g=crypto.getRandomValues(new Uint8Array(16))){let h=await i(g,a,f,b);return{encryptedKey:await e.L(a.slice(-6),h,c),p2c:f,p2s:(0,d.encode)(g)}}async function k(a,b,c,d,f){let g=await i(f,a,d,b);return e.o(a.slice(-6),g,c)}},41200:(a,b,c)=>{c.d(b,{j:()=>e});var d=c(3938);class e{#n;constructor(a){this.#n=new d.j(a)}setContentEncryptionKey(a){return this.#n.setContentEncryptionKey(a),this}setInitializationVector(a){return this.#n.setInitializationVector(a),this}setProtectedHeader(a){return this.#n.setProtectedHeader(a),this}setKeyManagementParameters(a){return this.#n.setKeyManagementParameters(a),this}async encrypt(a,b){let c=await this.#n.encrypt(a,b);return[c.protected,c.encrypted_key,c.iv,c.ciphertext,c.tag].join(".")}}},41330:(a,b,c)=>{function d(a,b,...c){if((c=c.filter(Boolean)).length>2){let b=c.pop();a+=`one of type ${c.join(", ")}, or ${b}.`}else 2===c.length?a+=`one of type ${c[0]} or ${c[1]}.`:a+=`of type ${c[0]}.`;return null==b?a+=` Received ${b}`:"function"==typeof b&&b.name?a+=` Received function ${b.name}`:"object"==typeof b&&null!=b&&b.constructor?.name&&(a+=` Received an instance of ${b.constructor.name}`),a}c.d(b,{X:()=>e,t:()=>f});let e=(a,...b)=>d("Key must be ",a,...b),f=(a,b,...c)=>d(`Key for the ${a} algorithm must be `,b,...c)},42253:(a,b,c)=>{c.d(b,{IG:()=>u,Jq:()=>k,Nj:()=>j,sc:()=>v,zp:()=>w});var d=c(41330),e=c(46379),f=c(33164),g=c(81316);let h=(a,b)=>{let c=(a.match(/.{1,64}/g)||[]).join("\n");return`-----BEGIN ${b}-----
${c}
-----END ${b}-----`},i=async(a,b,c)=>{if((0,g.D2)(c)){if(c.type!==a)throw TypeError(`key is not a ${a} key`);return c.export({format:"pem",type:b})}if(!(0,g.R7)(c))throw TypeError((0,d.X)(c,"CryptoKey","KeyObject"));if(!c.extractable)throw TypeError("CryptoKey is not extractable");if(c.type!==a)throw TypeError(`key is not a ${a} key`);return h((0,e.W)(new Uint8Array(await crypto.subtle.exportKey(b,c))),`${a.toUpperCase()} KEY`)},j=a=>i("public","spki",a),k=a=>i("private","pkcs8",a),l=(a,b)=>{if(a.byteLength!==b.length)return!1;for(let c=0;c<a.byteLength;c++)if(a[c]!==b[c])return!1;return!0},m=a=>({data:a,pos:0}),n=a=>{let b=a.data[a.pos++];if(128&b){let c=127&b,d=0;for(let b=0;b<c;b++)d=d<<8|a.data[a.pos++];return d}return b},o=(a,b=1)=>{if(b<=0)return;a.pos++;let c=n(a);a.pos+=c,b>1&&o(a,b-1)},p=(a,b,c)=>{if(a.data[a.pos++]!==b)throw Error(c)},q=(a,b)=>{let c=a.data.subarray(a.pos,a.pos+b);return a.pos+=b,c},r=a=>{let b=(a=>{p(a,6,"Expected algorithm OID");let b=n(a);return q(a,b)})(a);if(l(b,[43,101,110]))return"X25519";if(!l(b,[42,134,72,206,61,2,1]))throw Error("Unsupported key algorithm");p(a,6,"Expected curve OID");let c=n(a),d=q(a,c);for(let{name:a,oid:b}of[{name:"P-256",oid:[42,134,72,206,61,3,1,7]},{name:"P-384",oid:[43,129,4,0,34]},{name:"P-521",oid:[43,129,4,0,35]}])if(l(d,b))return a;throw Error("Unsupported named curve")},s=async(a,b,c,d)=>{let e,g,h="spki"===a,i=()=>h?["verify"]:["sign"];switch(c){case"PS256":case"PS384":case"PS512":e={name:"RSA-PSS",hash:`SHA-${c.slice(-3)}`},g=i();break;case"RS256":case"RS384":case"RS512":e={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${c.slice(-3)}`},g=i();break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":e={name:"RSA-OAEP",hash:`SHA-${parseInt(c.slice(-3),10)||1}`},g=h?["encrypt","wrapKey"]:["decrypt","unwrapKey"];break;case"ES256":case"ES384":case"ES512":e={name:"ECDSA",namedCurve:({ES256:"P-256",ES384:"P-384",ES512:"P-521"})[c]},g=i();break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":try{let a=d.getNamedCurve(b);e="X25519"===a?{name:"X25519"}:{name:"ECDH",namedCurve:a}}catch(a){throw new f.JOSENotSupported("Invalid or unsupported key format")}g=h?[]:["deriveBits"];break;case"Ed25519":case"EdDSA":e={name:"Ed25519"},g=i();break;case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":e={name:c},g=i();break;default:throw new f.JOSENotSupported('Invalid or unsupported "alg" (Algorithm) value')}return crypto.subtle.importKey(a,b,e,d?.extractable??!!h,g)},t=(a,b)=>(0,e.y)(a.replace(b,"")),u=(a,b,c)=>{let d=t(a,/(?:-----(?:BEGIN|END) PRIVATE KEY-----|\s)/g),e=c;return b?.startsWith?.("ECDH-ES")&&((e||={}).getNamedCurve=a=>{let b=m(a);return!function(a){p(a,48,"Invalid PKCS#8 structure"),n(a),p(a,2,"Expected version field");let b=n(a);a.pos+=b,p(a,48,"Expected algorithm identifier"),n(a),a.pos}(b),r(b)}),s("pkcs8",d,b,e)},v=(a,b,c)=>{let d=t(a,/(?:-----(?:BEGIN|END) PUBLIC KEY-----|\s)/g),e=c;return b?.startsWith?.("ECDH-ES")&&((e||={}).getNamedCurve=a=>{let b=m(a);return!function(a){p(a,48,"Invalid SPKI structure"),n(a),p(a,48,"Expected algorithm identifier"),n(a),a.pos}(b),r(b)}),s("spki",d,b,e)},w=(a,b,c)=>{let d;try{d=function(a){var b=t(a,/(?:-----(?:BEGIN|END) CERTIFICATE-----|\s)/g);let c=m(b);p(c,48,"Invalid certificate structure"),n(c),p(c,48,"Invalid tbsCertificate structure"),n(c),160===b[c.pos]?o(c,6):o(c,5);let d=c.pos;p(c,48,"Invalid SPKI structure");let e=n(c);return b.subarray(d,d+e+(c.pos-d))}(a)}catch(a){throw TypeError("Failed to parse the X.509 certificate",{cause:a})}return v(h((0,e.W)(d),"PUBLIC KEY"),b,c)}},43170:(a,b,c)=>{c.d(b,{L:()=>g,o:()=>h});var d=c(54095),e=c(47643),f=c(171);async function g(a,b,c,e){let g=a.slice(0,7),h=await (0,d.w)(g,c,b,e,new Uint8Array);return{encryptedKey:h.ciphertext,iv:(0,f.encode)(h.iv),tag:(0,f.encode)(h.tag)}}async function h(a,b,c,d,f){let g=a.slice(0,7);return(0,e.Y)(g,b,c,d,f,new Uint8Array)}},46379:(a,b,c)=>{function d(a){if(Uint8Array.prototype.toBase64)return a.toBase64();let b=[];for(let c=0;c<a.length;c+=32768)b.push(String.fromCharCode.apply(null,a.subarray(c,c+32768)));return btoa(b.join(""))}function e(a){if(Uint8Array.fromBase64)return Uint8Array.fromBase64(a);let b=atob(a),c=new Uint8Array(b.length);for(let a=0;a<b.length;a++)c[a]=b.charCodeAt(a);return c}c.d(b,{W:()=>d,y:()=>e})},47643:(a,b,c)=>{c.d(b,{Y:()=>n});var d=c(37432),e=c(34525),f=c(94123),g=c(33164),h=c(27701),i=c(41330),j=c(81316);async function k(a,b){if(!(a instanceof Uint8Array))throw TypeError("First argument must be a buffer");if(!(b instanceof Uint8Array))throw TypeError("Second argument must be a buffer");let c={name:"HMAC",hash:"SHA-256"},d=await crypto.subtle.generateKey(c,!1,["sign"]),e=new Uint8Array(await crypto.subtle.sign(c,d,a)),f=new Uint8Array(await crypto.subtle.sign(c,d,b)),g=0,h=-1;for(;++h<32;)g|=e[h]^f[h];return 0===g}async function l(a,b,c,e,f,h){let j,l;if(!(b instanceof Uint8Array))throw TypeError((0,i.X)(b,"Uint8Array"));let m=parseInt(a.slice(1,4),10),n=await crypto.subtle.importKey("raw",b.subarray(m>>3),"AES-CBC",!1,["decrypt"]),o=await crypto.subtle.importKey("raw",b.subarray(0,m>>3),{hash:`SHA-${m<<1}`,name:"HMAC"},!1,["sign"]),p=(0,d.xW)(h,e,c,(0,d.mx)(h.length<<3)),q=new Uint8Array((await crypto.subtle.sign("HMAC",o,p)).slice(0,m>>3));try{j=await k(f,q)}catch{}if(!j)throw new g.JWEDecryptionFailed;try{l=new Uint8Array(await crypto.subtle.decrypt({iv:e,name:"AES-CBC"},n,c))}catch{}if(!l)throw new g.JWEDecryptionFailed;return l}async function m(a,b,c,e,f,i){let j;b instanceof Uint8Array?j=await crypto.subtle.importKey("raw",b,"AES-GCM",!1,["decrypt"]):((0,h.$)(b,a,"decrypt"),j=b);try{return new Uint8Array(await crypto.subtle.decrypt({additionalData:i,iv:e,name:"AES-GCM",tagLength:128},j,(0,d.xW)(c,f)))}catch{throw new g.JWEDecryptionFailed}}async function n(a,b,c,d,h,k){if(!(0,j.R7)(b)&&!(b instanceof Uint8Array))throw TypeError((0,i.X)(b,"CryptoKey","KeyObject","Uint8Array","JSON Web Key"));if(!d)throw new g.JWEInvalid("JWE Initialization Vector missing");if(!h)throw new g.JWEInvalid("JWE Authentication Tag missing");switch((0,e.S)(a,d),a){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return b instanceof Uint8Array&&(0,f.W)(b,parseInt(a.slice(-3),10)),l(a,b,c,d,h,k);case"A128GCM":case"A192GCM":case"A256GCM":return b instanceof Uint8Array&&(0,f.W)(b,parseInt(a.slice(1,4),10)),m(a,b,c,d,h,k);default:throw new g.JOSENotSupported("Unsupported JWE Content Encryption Algorithm")}}},54095:(a,b,c)=>{c.d(b,{w:()=>n});var d=c(37432),e=c(34525),f=c(94123),g=c(27701),h=c(41330),i=c(67263),j=c(33164),k=c(81316);async function l(a,b,c,e,f){if(!(c instanceof Uint8Array))throw TypeError((0,h.X)(c,"Uint8Array"));let g=parseInt(a.slice(1,4),10),i=await crypto.subtle.importKey("raw",c.subarray(g>>3),"AES-CBC",!1,["encrypt"]),j=await crypto.subtle.importKey("raw",c.subarray(0,g>>3),{hash:`SHA-${g<<1}`,name:"HMAC"},!1,["sign"]),k=new Uint8Array(await crypto.subtle.encrypt({iv:e,name:"AES-CBC"},i,b)),l=(0,d.xW)(f,e,k,(0,d.mx)(f.length<<3));return{ciphertext:k,tag:new Uint8Array((await crypto.subtle.sign("HMAC",j,l)).slice(0,g>>3)),iv:e}}async function m(a,b,c,d,e){let f;c instanceof Uint8Array?f=await crypto.subtle.importKey("raw",c,"AES-GCM",!1,["encrypt"]):((0,g.$)(c,a,"encrypt"),f=c);let h=new Uint8Array(await crypto.subtle.encrypt({additionalData:e,iv:d,name:"AES-GCM",tagLength:128},f,b)),i=h.slice(-16);return{ciphertext:h.slice(0,-16),tag:i,iv:d}}async function n(a,b,c,d,g){if(!(0,k.R7)(c)&&!(c instanceof Uint8Array))throw TypeError((0,h.X)(c,"CryptoKey","KeyObject","Uint8Array","JSON Web Key"));switch(d?(0,e.S)(a,d):d=(0,i.n)(a),a){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return c instanceof Uint8Array&&(0,f.W)(c,parseInt(a.slice(-3),10)),l(a,b,c,d,g);case"A128GCM":case"A192GCM":case"A256GCM":return c instanceof Uint8Array&&(0,f.W)(c,parseInt(a.slice(1,4),10)),m(a,b,c,d,g);default:throw new j.JOSENotSupported("Unsupported JWE Content Encryption Algorithm")}}},66719:(a,b,c)=>{c.d(b,{f:()=>d});function d(...a){let b,c=a.filter(Boolean);if(0===c.length||1===c.length)return!0;for(let a of c){let c=Object.keys(a);if(!b||0===b.size){b=new Set(c);continue}for(let a of c){if(b.has(a))return!1;b.add(a)}}return!0}},67263:(a,b,c)=>{c.d(b,{a:()=>e,n:()=>f});var d=c(33164);function e(a){switch(a){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new d.JOSENotSupported(`Unsupported JWE Algorithm: ${a}`)}}let f=a=>crypto.getRandomValues(new Uint8Array(e(a)>>3))},68049:(a,b,c)=>{c.d(b,{s:()=>o});var d=c(1519),e=c(33656),f=c(39976),g=c(75340),h=c(171),i=c(80801),j=c(4931),k=c(33164),l=c(98843),m=c(43170),n=c(81316);async function o(a,b,c,p,q={}){let r,s,t;switch(a){case"dir":t=c;break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let f;if((0,n.Tz)(c),!e.T(c))throw new k.JOSENotSupported("ECDH with the provided key is not allowed or not supported by your javascript runtime");let{apu:g,apv:m}=q;f=q.epk?await (0,i.l)(q.epk,a):(await crypto.subtle.generateKey(c.algorithm,!0,["deriveBits"])).privateKey;let{x:o,y:u,crv:v,kty:w}=await (0,l.JU)(f),x=await e.H(c,f,"ECDH-ES"===a?b:a,"ECDH-ES"===a?(0,j.u)(b):parseInt(a.slice(-5,-2),10),g,m);if(s={epk:{x:o,crv:v,kty:w}},"EC"===w&&(s.epk.y=u),g&&(s.apu=(0,h.encode)(g)),m&&(s.apv=(0,h.encode)(m)),"ECDH-ES"===a){t=x;break}t=p||(0,j.D)(b);let y=a.slice(-6);r=await d.L(y,x,t);break}case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":t=p||(0,j.D)(b),(0,n.Tz)(c),r=await g.w(a,c,t);break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{t=p||(0,j.D)(b);let{p2c:d,p2s:e}=q;({encryptedKey:r,...s}=await f.L(a,c,t,d,e));break}case"A128KW":case"A192KW":case"A256KW":t=p||(0,j.D)(b),r=await d.L(a,c,t);break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{t=p||(0,j.D)(b);let{iv:d}=q;({encryptedKey:r,...s}=await (0,m.L)(a,c,t,d));break}default:throw new k.JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:t,encryptedKey:r,parameters:s}}},72892:(a,b,c)=>{c.d(b,{b:()=>d});async function d(a,b){let c=`SHA-${a.slice(-3)}`;return new Uint8Array(await crypto.subtle.digest(c,b))}},75340:(a,b,c)=>{c.d(b,{Y:()=>i,w:()=>h});var d=c(27701),e=c(80193),f=c(33164);let g=a=>{switch(a){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return"RSA-OAEP";default:throw new f.JOSENotSupported(`alg ${a} is not supported either by JOSE or your javascript runtime`)}};async function h(a,b,c){return(0,d.$)(b,a,"encrypt"),(0,e.O)(a,b),new Uint8Array(await crypto.subtle.encrypt(g(a),b,c))}async function i(a,b,c){return(0,d.$)(b,a,"decrypt"),(0,e.O)(a,b),new Uint8Array(await crypto.subtle.decrypt(g(a),b,c))}},76884:(a,b,c)=>{c.d(b,{x:()=>e});var d=c(33164);async function e(a){if(!a.alg)throw TypeError('"alg" argument is required when "jwk.alg" is not present');let{algorithm:b,keyUsages:c}=function(a){let b,c;switch(a.kty){case"AKP":switch(a.alg){case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":b={name:a.alg},c=a.priv?["sign"]:["verify"];break;default:throw new d.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"RSA":switch(a.alg){case"PS256":case"PS384":case"PS512":b={name:"RSA-PSS",hash:`SHA-${a.alg.slice(-3)}`},c=a.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":b={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${a.alg.slice(-3)}`},c=a.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":b={name:"RSA-OAEP",hash:`SHA-${parseInt(a.alg.slice(-3),10)||1}`},c=a.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new d.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"EC":switch(a.alg){case"ES256":b={name:"ECDSA",namedCurve:"P-256"},c=a.d?["sign"]:["verify"];break;case"ES384":b={name:"ECDSA",namedCurve:"P-384"},c=a.d?["sign"]:["verify"];break;case"ES512":b={name:"ECDSA",namedCurve:"P-521"},c=a.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":b={name:"ECDH",namedCurve:a.crv},c=a.d?["deriveBits"]:[];break;default:throw new d.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"OKP":switch(a.alg){case"Ed25519":case"EdDSA":b={name:"Ed25519"},c=a.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":b={name:a.crv},c=a.d?["deriveBits"]:[];break;default:throw new d.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;default:throw new d.JOSENotSupported('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:b,keyUsages:c}}(a),e={...a};return"AKP"!==e.kty&&delete e.alg,delete e.use,crypto.subtle.importKey("jwk",e,b,a.ext??(!a.d&&!a.priv),a.key_ops??c)}},80053:(a,b,c)=>{c.d(b,{y:()=>i});var d=c(41330),e=c(81316),f=c(33999);let g=a=>a?.[Symbol.toStringTag],h=(a,b,c)=>{if(void 0!==b.use){let a;switch(c){case"sign":case"verify":a="sig";break;case"encrypt":case"decrypt":a="enc"}if(b.use!==a)throw TypeError(`Invalid key for this operation, its "use" must be "${a}" when present`)}if(void 0!==b.alg&&b.alg!==a)throw TypeError(`Invalid key for this operation, its "alg" must be "${a}" when present`);if(Array.isArray(b.key_ops)){let d;switch(!0){case"sign"===c||"verify"===c:case"dir"===a:case a.includes("CBC-HS"):d=c;break;case a.startsWith("PBES2"):d="deriveBits";break;case/^A\d{3}(?:GCM)?(?:KW)?$/.test(a):d=!a.includes("GCM")&&a.endsWith("KW")?"encrypt"===c?"wrapKey":"unwrapKey":c;break;case"encrypt"===c&&a.startsWith("RSA"):d="wrapKey";break;case"decrypt"===c:d=a.startsWith("RSA")?"unwrapKey":"deriveBits"}if(d&&b.key_ops?.includes?.(d)===!1)throw TypeError(`Invalid key for this operation, its "key_ops" must include "${d}" when present`)}return!0};function i(a,b,c){switch(a.substring(0,2)){case"A1":case"A2":case"di":case"HS":case"PB":((a,b,c)=>{if(!(b instanceof Uint8Array)){if(f.ll(b)){if(f.t9(b)&&h(a,b,c))return;throw TypeError('JSON Web Key for symmetric algorithms must have JWK "kty" (Key Type) equal to "oct" and the JWK "k" (Key Value) present')}if(!(0,e.P2)(b))throw TypeError((0,d.t)(a,b,"CryptoKey","KeyObject","JSON Web Key","Uint8Array"));if("secret"!==b.type)throw TypeError(`${g(b)} instances for symmetric algorithms must be of type "secret"`)}})(a,b,c);break;default:((a,b,c)=>{if(f.ll(b))switch(c){case"decrypt":case"sign":if(f.W2(b)&&h(a,b,c))return;throw TypeError("JSON Web Key for this operation must be a private JWK");case"encrypt":case"verify":if(f.M3(b)&&h(a,b,c))return;throw TypeError("JSON Web Key for this operation must be a public JWK")}if(!(0,e.P2)(b))throw TypeError((0,d.t)(a,b,"CryptoKey","KeyObject","JSON Web Key"));if("secret"===b.type)throw TypeError(`${g(b)} instances for asymmetric algorithms must not be of type "secret"`);if("public"===b.type)switch(c){case"sign":throw TypeError(`${g(b)} instances for asymmetric algorithm signing must be of type "private"`);case"decrypt":throw TypeError(`${g(b)} instances for asymmetric algorithm decryption must be of type "private"`)}if("private"===b.type)switch(c){case"verify":throw TypeError(`${g(b)} instances for asymmetric algorithm verifying must be of type "public"`);case"encrypt":throw TypeError(`${g(b)} instances for asymmetric algorithm encryption must be of type "public"`)}})(a,b,c)}}},80193:(a,b,c)=>{c.d(b,{O:()=>d});function d(a,b){if(a.startsWith("RS")||a.startsWith("PS")){let{modulusLength:c}=b.algorithm;if("number"!=typeof c||c<2048)throw TypeError(`${a} requires key modulusLength to be 2048 bits or larger`)}}},80801:(a,b,c)=>{let d;c.d(b,{l:()=>j});var e=c(33999),f=c(171),g=c(76884),h=c(81316);let i=async(a,b,c,e=!1)=>{let f=(d||=new WeakMap).get(a);if(f?.[c])return f[c];let h=await (0,g.x)({...b,alg:c});return e&&Object.freeze(a),f?f[c]=h:d.set(a,{[c]:h}),h};async function j(a,b){if(a instanceof Uint8Array||(0,h.R7)(a))return a;if((0,h.D2)(a)){if("secret"===a.type)return a.export();if("toCryptoKey"in a&&"function"==typeof a.toCryptoKey)try{return((a,b)=>{let c,e=(d||=new WeakMap).get(a);if(e?.[b])return e[b];let f="public"===a.type,g=!!f;if("x25519"===a.asymmetricKeyType){switch(b){case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":break;default:throw TypeError("given KeyObject instance cannot be used for this algorithm")}c=a.toCryptoKey(a.asymmetricKeyType,g,f?[]:["deriveBits"])}if("ed25519"===a.asymmetricKeyType){if("EdDSA"!==b&&"Ed25519"!==b)throw TypeError("given KeyObject instance cannot be used for this algorithm");c=a.toCryptoKey(a.asymmetricKeyType,g,[f?"verify":"sign"])}switch(a.asymmetricKeyType){case"ml-dsa-44":case"ml-dsa-65":case"ml-dsa-87":if(b!==a.asymmetricKeyType.toUpperCase())throw TypeError("given KeyObject instance cannot be used for this algorithm");c=a.toCryptoKey(a.asymmetricKeyType,g,[f?"verify":"sign"])}if("rsa"===a.asymmetricKeyType){let d;switch(b){case"RSA-OAEP":d="SHA-1";break;case"RS256":case"PS256":case"RSA-OAEP-256":d="SHA-256";break;case"RS384":case"PS384":case"RSA-OAEP-384":d="SHA-384";break;case"RS512":case"PS512":case"RSA-OAEP-512":d="SHA-512";break;default:throw TypeError("given KeyObject instance cannot be used for this algorithm")}if(b.startsWith("RSA-OAEP"))return a.toCryptoKey({name:"RSA-OAEP",hash:d},g,f?["encrypt"]:["decrypt"]);c=a.toCryptoKey({name:b.startsWith("PS")?"RSA-PSS":"RSASSA-PKCS1-v1_5",hash:d},g,[f?"verify":"sign"])}if("ec"===a.asymmetricKeyType){let d=new Map([["prime256v1","P-256"],["secp384r1","P-384"],["secp521r1","P-521"]]).get(a.asymmetricKeyDetails?.namedCurve);if(!d)throw TypeError("given KeyObject instance cannot be used for this algorithm");"ES256"===b&&"P-256"===d&&(c=a.toCryptoKey({name:"ECDSA",namedCurve:d},g,[f?"verify":"sign"])),"ES384"===b&&"P-384"===d&&(c=a.toCryptoKey({name:"ECDSA",namedCurve:d},g,[f?"verify":"sign"])),"ES512"===b&&"P-521"===d&&(c=a.toCryptoKey({name:"ECDSA",namedCurve:d},g,[f?"verify":"sign"])),b.startsWith("ECDH-ES")&&(c=a.toCryptoKey({name:"ECDH",namedCurve:d},g,f?[]:["deriveBits"]))}if(!c)throw TypeError("given KeyObject instance cannot be used for this algorithm");return e?e[b]=c:d.set(a,{[b]:c}),c})(a,b)}catch(a){if(a instanceof TypeError)throw a}let c=a.export({format:"jwk"});return i(a,c,b)}if((0,e.ll)(a))return a.k?(0,f.decode)(a.k):i(a,a,b,!0);throw Error("unreachable")}},81316:(a,b,c)=>{function d(a){if(!e(a))throw Error("CryptoKey instance expected")}c.d(b,{D2:()=>f,P2:()=>g,R7:()=>e,Tz:()=>d});let e=a=>{if(a?.[Symbol.toStringTag]==="CryptoKey")return!0;try{return a instanceof CryptoKey}catch{return!1}},f=a=>a?.[Symbol.toStringTag]==="KeyObject",g=a=>e(a)||f(a)},81815:(a,b,c)=>{c.d(b,{o:()=>d});let d=Symbol()},91161:(a,b,c)=>{c.d(b,{d:()=>w});var d=c(171),e=c(47643),f=c(33164),g=c(66719),h=c(32712),i=c(1519),j=c(33656),k=c(39976),l=c(75340),m=c(4931),n=c(92545),o=c(43170),p=c(81316);async function q(a,b,c,e,g){switch(a){case"dir":if(void 0!==c)throw new f.JWEInvalid("Encountered unexpected JWE Encrypted Key");return b;case"ECDH-ES":if(void 0!==c)throw new f.JWEInvalid("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let g,k;if(!(0,h.G)(e.epk))throw new f.JWEInvalid('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if((0,p.Tz)(b),!j.T(b))throw new f.JOSENotSupported("ECDH with the provided key is not allowed or not supported by your javascript runtime");let l=await (0,n.Og)(e.epk,a);if((0,p.Tz)(l),void 0!==e.apu){if("string"!=typeof e.apu)throw new f.JWEInvalid('JOSE Header "apu" (Agreement PartyUInfo) invalid');try{g=(0,d.decode)(e.apu)}catch{throw new f.JWEInvalid("Failed to base64url decode the apu")}}if(void 0!==e.apv){if("string"!=typeof e.apv)throw new f.JWEInvalid('JOSE Header "apv" (Agreement PartyVInfo) invalid');try{k=(0,d.decode)(e.apv)}catch{throw new f.JWEInvalid("Failed to base64url decode the apv")}}let o=await j.H(l,b,"ECDH-ES"===a?e.enc:a,"ECDH-ES"===a?(0,m.u)(e.enc):parseInt(a.slice(-5,-2),10),g,k);if("ECDH-ES"===a)return o;if(void 0===c)throw new f.JWEInvalid("JWE Encrypted Key missing");return i.o(a.slice(-6),o,c)}case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":if(void 0===c)throw new f.JWEInvalid("JWE Encrypted Key missing");return(0,p.Tz)(b),l.Y(a,b,c);case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{let h;if(void 0===c)throw new f.JWEInvalid("JWE Encrypted Key missing");if("number"!=typeof e.p2c)throw new f.JWEInvalid('JOSE Header "p2c" (PBES2 Count) missing or invalid');let i=g?.maxPBES2Count||1e4;if(e.p2c>i)throw new f.JWEInvalid('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if("string"!=typeof e.p2s)throw new f.JWEInvalid('JOSE Header "p2s" (PBES2 Salt) missing or invalid');try{h=(0,d.decode)(e.p2s)}catch{throw new f.JWEInvalid("Failed to base64url decode the p2s")}return k.o(a,b,c,e.p2c,h)}case"A128KW":case"A192KW":case"A256KW":if(void 0===c)throw new f.JWEInvalid("JWE Encrypted Key missing");return i.o(a,b,c);case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{let g,h;if(void 0===c)throw new f.JWEInvalid("JWE Encrypted Key missing");if("string"!=typeof e.iv)throw new f.JWEInvalid('JOSE Header "iv" (Initialization Vector) missing or invalid');if("string"!=typeof e.tag)throw new f.JWEInvalid('JOSE Header "tag" (Authentication Tag) missing or invalid');try{g=(0,d.decode)(e.iv)}catch{throw new f.JWEInvalid("Failed to base64url decode the iv")}try{h=(0,d.decode)(e.tag)}catch{throw new f.JWEInvalid("Failed to base64url decode the tag")}return(0,o.o)(a,b,c,g,h)}default:throw new f.JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}}var r=c(37432),s=c(17969),t=c(1911),u=c(80801),v=c(80053);async function w(a,b,c){let i,j,k,l,n,o,p;if(!(0,h.G)(a))throw new f.JWEInvalid("Flattened JWE must be an object");if(void 0===a.protected&&void 0===a.header&&void 0===a.unprotected)throw new f.JWEInvalid("JOSE Header missing");if(void 0!==a.iv&&"string"!=typeof a.iv)throw new f.JWEInvalid("JWE Initialization Vector incorrect type");if("string"!=typeof a.ciphertext)throw new f.JWEInvalid("JWE Ciphertext missing or incorrect type");if(void 0!==a.tag&&"string"!=typeof a.tag)throw new f.JWEInvalid("JWE Authentication Tag incorrect type");if(void 0!==a.protected&&"string"!=typeof a.protected)throw new f.JWEInvalid("JWE Protected Header incorrect type");if(void 0!==a.encrypted_key&&"string"!=typeof a.encrypted_key)throw new f.JWEInvalid("JWE Encrypted Key incorrect type");if(void 0!==a.aad&&"string"!=typeof a.aad)throw new f.JWEInvalid("JWE AAD incorrect type");if(void 0!==a.header&&!(0,h.G)(a.header))throw new f.JWEInvalid("JWE Shared Unprotected Header incorrect type");if(void 0!==a.unprotected&&!(0,h.G)(a.unprotected))throw new f.JWEInvalid("JWE Per-Recipient Unprotected Header incorrect type");if(a.protected)try{let b=(0,d.decode)(a.protected);i=JSON.parse(r.D0.decode(b))}catch{throw new f.JWEInvalid("JWE Protected Header is invalid")}if(!(0,g.f)(i,a.header,a.unprotected))throw new f.JWEInvalid("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");let w={...i,...a.header,...a.unprotected};if((0,s.n)(f.JWEInvalid,new Map,c?.crit,i,w),void 0!==w.zip)throw new f.JOSENotSupported('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');let{alg:x,enc:y}=w;if("string"!=typeof x||!x)throw new f.JWEInvalid("missing JWE Algorithm (alg) in JWE Header");if("string"!=typeof y||!y)throw new f.JWEInvalid("missing JWE Encryption Algorithm (enc) in JWE Header");let z=c&&(0,t.F)("keyManagementAlgorithms",c.keyManagementAlgorithms),A=c&&(0,t.F)("contentEncryptionAlgorithms",c.contentEncryptionAlgorithms);if(z&&!z.has(x)||!z&&x.startsWith("PBES2"))throw new f.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter value not allowed');if(A&&!A.has(y))throw new f.JOSEAlgNotAllowed('"enc" (Encryption Algorithm) Header Parameter value not allowed');if(void 0!==a.encrypted_key)try{j=(0,d.decode)(a.encrypted_key)}catch{throw new f.JWEInvalid("Failed to base64url decode the encrypted_key")}let B=!1;"function"==typeof b&&(b=await b(i,a),B=!0),(0,v.y)("dir"===x?y:x,b,"decrypt");let C=await (0,u.l)(b,x);try{k=await q(x,C,j,w,c)}catch(a){if(a instanceof TypeError||a instanceof f.JWEInvalid||a instanceof f.JOSENotSupported)throw a;k=(0,m.D)(y)}if(void 0!==a.iv)try{l=(0,d.decode)(a.iv)}catch{throw new f.JWEInvalid("Failed to base64url decode the iv")}if(void 0!==a.tag)try{n=(0,d.decode)(a.tag)}catch{throw new f.JWEInvalid("Failed to base64url decode the tag")}let D=void 0!==a.protected?(0,r.lF)(a.protected):new Uint8Array;o=void 0!==a.aad?(0,r.xW)(D,(0,r.lF)("."),(0,r.lF)(a.aad)):D;try{p=(0,d.decode)(a.ciphertext)}catch{throw new f.JWEInvalid("Failed to base64url decode the ciphertext")}let E={plaintext:await (0,e.Y)(y,k,p,l,n,o)};if(void 0!==a.protected&&(E.protectedHeader=i),void 0!==a.aad)try{E.additionalAuthenticatedData=(0,d.decode)(a.aad)}catch{throw new f.JWEInvalid("Failed to base64url decode the aad")}return(void 0!==a.unprotected&&(E.sharedUnprotectedHeader=a.unprotected),void 0!==a.header&&(E.unprotectedHeader=a.header),B)?{...E,key:C}:E}},92545:(a,b,c)=>{c.d(b,{Lf:()=>k,Mh:()=>j,Og:()=>l,jU:()=>i});var d=c(171),e=c(42253),f=c(76884),g=c(33164),h=c(32712);async function i(a,b,c){if("string"!=typeof a||0!==a.indexOf("-----BEGIN PUBLIC KEY-----"))throw TypeError('"spki" must be SPKI formatted string');return(0,e.sc)(a,b,c)}async function j(a,b,c){if("string"!=typeof a||0!==a.indexOf("-----BEGIN CERTIFICATE-----"))throw TypeError('"x509" must be X.509 formatted string');return(0,e.zp)(a,b,c)}async function k(a,b,c){if("string"!=typeof a||0!==a.indexOf("-----BEGIN PRIVATE KEY-----"))throw TypeError('"pkcs8" must be PKCS#8 formatted string');return(0,e.IG)(a,b,c)}async function l(a,b,c){let e;if(!(0,h.G)(a))throw TypeError("JWK must be an object");switch(b??=a.alg,e??=c?.extractable??a.ext,a.kty){case"oct":if("string"!=typeof a.k||!a.k)throw TypeError('missing "k" (Key Value) Parameter value');return(0,d.decode)(a.k);case"RSA":if("oth"in a&&void 0!==a.oth)throw new g.JOSENotSupported('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');return(0,f.x)({...a,alg:b,ext:e});case"AKP":if("string"!=typeof a.alg||!a.alg)throw TypeError('missing "alg" (Algorithm) Parameter value');if(void 0!==b&&b!==a.alg)throw TypeError("JWK alg and alg option value mismatch");return(0,f.x)({...a,ext:e});case"EC":case"OKP":return(0,f.x)({...a,alg:b,ext:e});default:throw new g.JOSENotSupported('Unsupported "kty" (Key Type) Parameter value')}}},94123:(a,b,c)=>{c.d(b,{W:()=>e});var d=c(33164);function e(a,b){let c=a.byteLength<<3;if(c!==b)throw new d.JWEInvalid(`Invalid Content Encryption Key length. Expected ${b} bits, got ${c} bits`)}},94133:(a,b,c)=>{c.d(b,{B:()=>g});var d=c(5716),e=c(7448),f=c(33164);async function g(a,b,c){let g=await (0,d.d)(a,b,c),h=(0,e.k6)(g.protectedHeader,g.plaintext,c),{protectedHeader:i}=g;if(void 0!==i.iss&&i.iss!==h.iss)throw new f.JWTClaimValidationFailed('replicated "iss" claim header parameter mismatch',h,"iss","mismatch");if(void 0!==i.sub&&i.sub!==h.sub)throw new f.JWTClaimValidationFailed('replicated "sub" claim header parameter mismatch',h,"sub","mismatch");if(void 0!==i.aud&&JSON.stringify(i.aud)!==JSON.stringify(h.aud))throw new f.JWTClaimValidationFailed('replicated "aud" claim header parameter mismatch',h,"aud","mismatch");let j={payload:h,protectedHeader:i};return"function"==typeof b?{...j,key:g.key}:j}},98843:(a,b,c)=>{c.d(b,{JU:()=>k,Yp:()=>j,Y5:()=>i});var d=c(42253),e=c(41330),f=c(171),g=c(81316);async function h(a){if((0,g.D2)(a))if("secret"!==a.type)return a.export({format:"jwk"});else a=a.export();if(a instanceof Uint8Array)return{kty:"oct",k:(0,f.encode)(a)};if(!(0,g.R7)(a))throw TypeError((0,e.X)(a,"CryptoKey","KeyObject","Uint8Array"));if(!a.extractable)throw TypeError("non-extractable CryptoKey cannot be exported as a JWK");let{ext:b,key_ops:c,alg:d,use:h,...i}=await crypto.subtle.exportKey("jwk",a);return"AKP"===i.kty&&(i.alg=d),i}async function i(a){return(0,d.Nj)(a)}async function j(a){return(0,d.Jq)(a)}async function k(a){return h(a)}}};