"use strict";exports.id=494,exports.ids=[494],exports.modules={4494:(a,b,c)=>{let d;c.r(b),c.d(b,{CompactEncrypt:()=>I.j,CompactSign:()=>L,EmbeddedJWK:()=>Y,EncryptJWT:()=>P.L,FlattenedEncrypt:()=>j.j,FlattenedSign:()=>K,GeneralEncrypt:()=>t,GeneralSign:()=>N,SignJWT:()=>O,UnsecuredJWT:()=>ag,base64url:()=>o,calculateJwkThumbprint:()=>V,calculateJwkThumbprintUri:()=>W,compactDecrypt:()=>e.d,compactVerify:()=>D,createLocalJWKSet:()=>aa,createRemoteJWKSet:()=>af,cryptoRuntime:()=>am,customFetch:()=>ab,decodeJwt:()=>ai,decodeProtectedHeader:()=>ah,errors:()=>g,exportJWK:()=>T.JU,exportPKCS8:()=>T.Yp,exportSPKI:()=>T.Y5,flattenedDecrypt:()=>f.d,flattenedVerify:()=>C,generalDecrypt:()=>i,generalVerify:()=>E,generateKeyPair:()=>ak,generateSecret:()=>al,importJWK:()=>X.Og,importPKCS8:()=>X.Lf,importSPKI:()=>X.jU,importX509:()=>X.Mh,jwksCache:()=>ad,jwtDecrypt:()=>H.B,jwtVerify:()=>G});var e=c(5716),f=c(91161),g=c(33164),h=c(32712);async function i(a,b,c){if(!(0,h.G)(a))throw new g.JWEInvalid("General JWE must be an object");if(!Array.isArray(a.recipients)||!a.recipients.every(h.G))throw new g.JWEInvalid("JWE Recipients missing or incorrect type");if(!a.recipients.length)throw new g.JWEInvalid("JWE Recipients has no members");for(let d of a.recipients)try{return await (0,f.d)({aad:a.aad,ciphertext:a.ciphertext,encrypted_key:d.encrypted_key,header:d.header,iv:a.iv,protected:a.protected,tag:a.tag,unprotected:a.unprotected},b,c)}catch{}throw new g.JWEDecryptionFailed}var j=c(3938),k=c(81815),l=c(4931),m=c(66719),n=c(68049),o=c(171),p=c(17969),q=c(80801),r=c(80053);class s{#a;unprotectedHeader;keyManagementParameters;key;options;constructor(a,b,c){this.#a=a,this.key=b,this.options=c}setUnprotectedHeader(a){if(this.unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=a,this}setKeyManagementParameters(a){if(this.keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this.keyManagementParameters=a,this}addRecipient(...a){return this.#a.addRecipient(...a)}encrypt(...a){return this.#a.encrypt(...a)}done(){return this.#a}}class t{#b;#c=[];#d;#e;#f;constructor(a){this.#b=a}addRecipient(a,b){let c=new s(this,a,{crit:b?.crit});return this.#c.push(c),c}setProtectedHeader(a){if(this.#d)throw TypeError("setProtectedHeader can only be called once");return this.#d=a,this}setSharedUnprotectedHeader(a){if(this.#e)throw TypeError("setSharedUnprotectedHeader can only be called once");return this.#e=a,this}setAdditionalAuthenticatedData(a){return this.#f=a,this}async encrypt(){let a;if(!this.#c.length)throw new g.JWEInvalid("at least one recipient must be added");if(1===this.#c.length){let[a]=this.#c,b=await new j.j(this.#b).setAdditionalAuthenticatedData(this.#f).setProtectedHeader(this.#d).setSharedUnprotectedHeader(this.#e).setUnprotectedHeader(a.unprotectedHeader).encrypt(a.key,{...a.options}),c={ciphertext:b.ciphertext,iv:b.iv,recipients:[{}],tag:b.tag};return b.aad&&(c.aad=b.aad),b.protected&&(c.protected=b.protected),b.unprotected&&(c.unprotected=b.unprotected),b.encrypted_key&&(c.recipients[0].encrypted_key=b.encrypted_key),b.header&&(c.recipients[0].header=b.header),c}for(let b=0;b<this.#c.length;b++){let c=this.#c[b];if(!(0,m.f)(this.#d,this.#e,c.unprotectedHeader))throw new g.JWEInvalid("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let d={...this.#d,...this.#e,...c.unprotectedHeader},{alg:e}=d;if("string"!=typeof e||!e)throw new g.JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("dir"===e||"ECDH-ES"===e)throw new g.JWEInvalid('"dir" and "ECDH-ES" alg may only be used with a single recipient');if("string"!=typeof d.enc||!d.enc)throw new g.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if(a){if(a!==d.enc)throw new g.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter must be the same for all recipients')}else a=d.enc;if((0,p.n)(g.JWEInvalid,new Map,c.options.crit,this.#d,d),void 0!==d.zip)throw new g.JOSENotSupported('JWE "zip" (Compression Algorithm) Header Parameter is not supported.')}let b=(0,l.D)(a),c={ciphertext:"",recipients:[]};for(let d=0;d<this.#c.length;d++){let e=this.#c[d],f={};if(c.recipients.push(f),0===d){let a=await new j.j(this.#b).setAdditionalAuthenticatedData(this.#f).setContentEncryptionKey(b).setProtectedHeader(this.#d).setSharedUnprotectedHeader(this.#e).setUnprotectedHeader(e.unprotectedHeader).setKeyManagementParameters(e.keyManagementParameters).encrypt(e.key,{...e.options,[k.o]:!0});c.ciphertext=a.ciphertext,c.iv=a.iv,c.tag=a.tag,a.aad&&(c.aad=a.aad),a.protected&&(c.protected=a.protected),a.unprotected&&(c.unprotected=a.unprotected),f.encrypted_key=a.encrypted_key,a.header&&(f.header=a.header);continue}let g=e.unprotectedHeader?.alg||this.#d?.alg||this.#e?.alg;(0,r.y)("dir"===g?a:g,e.key,"encrypt");let h=await (0,q.l)(e.key,g),{encryptedKey:i,parameters:l}=await (0,n.s)(g,a,h,b,e.keyManagementParameters);f.encrypted_key=(0,o.encode)(i),(e.unprotectedHeader||l)&&(f.header={...e.unprotectedHeader,...l})}return c}}function u(a,b){let c=`SHA-${a.slice(-3)}`;switch(a){case"HS256":case"HS384":case"HS512":return{hash:c,name:"HMAC"};case"PS256":case"PS384":case"PS512":return{hash:c,name:"RSA-PSS",saltLength:parseInt(a.slice(-3),10)>>3};case"RS256":case"RS384":case"RS512":return{hash:c,name:"RSASSA-PKCS1-v1_5"};case"ES256":case"ES384":case"ES512":return{hash:c,name:"ECDSA",namedCurve:b.namedCurve};case"Ed25519":case"EdDSA":return{name:"Ed25519"};case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":return{name:a};default:throw new g.JOSENotSupported(`alg ${a} is not supported either by JOSE or your javascript runtime`)}}var v=c(80193),w=c(27701),x=c(41330);async function y(a,b,c){if(b instanceof Uint8Array){if(!a.startsWith("HS"))throw TypeError((0,x.X)(b,"CryptoKey","KeyObject","JSON Web Key"));return crypto.subtle.importKey("raw",b,{hash:`SHA-${a.slice(-3)}`,name:"HMAC"},!1,[c])}return(0,w.Y)(b,a,c),b}async function z(a,b,c,d){let e=await y(a,b,"verify");(0,v.O)(a,e);let f=u(a,e.algorithm);try{return await crypto.subtle.verify(f,e,c,d)}catch{return!1}}var A=c(37432),B=c(1911);async function C(a,b,c){let d,e;if(!(0,h.G)(a))throw new g.JWSInvalid("Flattened JWS must be an object");if(void 0===a.protected&&void 0===a.header)throw new g.JWSInvalid('Flattened JWS must have either of the "protected" or "header" members');if(void 0!==a.protected&&"string"!=typeof a.protected)throw new g.JWSInvalid("JWS Protected Header incorrect type");if(void 0===a.payload)throw new g.JWSInvalid("JWS Payload missing");if("string"!=typeof a.signature)throw new g.JWSInvalid("JWS Signature missing or incorrect type");if(void 0!==a.header&&!(0,h.G)(a.header))throw new g.JWSInvalid("JWS Unprotected Header incorrect type");let f={};if(a.protected)try{let b=(0,o.decode)(a.protected);f=JSON.parse(A.D0.decode(b))}catch{throw new g.JWSInvalid("JWS Protected Header is invalid")}if(!(0,m.f)(f,a.header))throw new g.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let i={...f,...a.header},j=(0,p.n)(g.JWSInvalid,new Map([["b64",!0]]),c?.crit,f,i),k=!0;if(j.has("b64")&&"boolean"!=typeof(k=f.b64))throw new g.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:l}=i;if("string"!=typeof l||!l)throw new g.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');let n=c&&(0,B.F)("algorithms",c.algorithms);if(n&&!n.has(l))throw new g.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter value not allowed');if(k){if("string"!=typeof a.payload)throw new g.JWSInvalid("JWS Payload must be a string")}else if("string"!=typeof a.payload&&!(a.payload instanceof Uint8Array))throw new g.JWSInvalid("JWS Payload must be a string or an Uint8Array instance");let s=!1;"function"==typeof b&&(b=await b(f,a),s=!0),(0,r.y)(l,b,"verify");let t=(0,A.xW)(void 0!==a.protected?(0,A.lF)(a.protected):new Uint8Array,(0,A.lF)("."),"string"==typeof a.payload?k?(0,A.lF)(a.payload):A.Rd.encode(a.payload):a.payload);try{d=(0,o.decode)(a.signature)}catch{throw new g.JWSInvalid("Failed to base64url decode the signature")}let u=await (0,q.l)(b,l);if(!await z(l,u,d,t))throw new g.JWSSignatureVerificationFailed;if(k)try{e=(0,o.decode)(a.payload)}catch{throw new g.JWSInvalid("Failed to base64url decode the payload")}else e="string"==typeof a.payload?A.Rd.encode(a.payload):a.payload;let v={payload:e};return(void 0!==a.protected&&(v.protectedHeader=f),void 0!==a.header&&(v.unprotectedHeader=a.header),s)?{...v,key:u}:v}async function D(a,b,c){if(a instanceof Uint8Array&&(a=A.D0.decode(a)),"string"!=typeof a)throw new g.JWSInvalid("Compact JWS must be a string or Uint8Array");let{0:d,1:e,2:f,length:h}=a.split(".");if(3!==h)throw new g.JWSInvalid("Invalid Compact JWS");let i=await C({payload:e,protected:d,signature:f},b,c),j={payload:i.payload,protectedHeader:i.protectedHeader};return"function"==typeof b?{...j,key:i.key}:j}async function E(a,b,c){if(!(0,h.G)(a))throw new g.JWSInvalid("General JWS must be an object");if(!Array.isArray(a.signatures)||!a.signatures.every(h.G))throw new g.JWSInvalid("JWS Signatures missing or incorrect type");for(let d of a.signatures)try{return await C({header:d.header,payload:a.payload,protected:d.protected,signature:d.signature},b,c)}catch{}throw new g.JWSSignatureVerificationFailed}var F=c(7448);async function G(a,b,c){let d=await D(a,b,c);if(d.protectedHeader.crit?.includes("b64")&&!1===d.protectedHeader.b64)throw new g.JWTInvalid("JWTs MUST NOT use unencoded payload");let e={payload:(0,F.k6)(d.protectedHeader,d.payload,c),protectedHeader:d.protectedHeader};return"function"==typeof b?{...e,key:d.key}:e}var H=c(94133),I=c(41200);async function J(a,b,c){let d=await y(a,b,"sign");return(0,v.O)(a,d),new Uint8Array(await crypto.subtle.sign(u(a,d.algorithm),d,c))}class K{#g;#d;#e;constructor(a){if(!(a instanceof Uint8Array))throw TypeError("payload must be an instance of Uint8Array");this.#g=a}setProtectedHeader(a){if(this.#d)throw TypeError("setProtectedHeader can only be called once");return this.#d=a,this}setUnprotectedHeader(a){if(this.#e)throw TypeError("setUnprotectedHeader can only be called once");return this.#e=a,this}async sign(a,b){let c,d,e,f;if(!this.#d&&!this.#e)throw new g.JWSInvalid("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!(0,m.f)(this.#d,this.#e))throw new g.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let h={...this.#d,...this.#e},i=(0,p.n)(g.JWSInvalid,new Map([["b64",!0]]),b?.crit,this.#d,h),j=!0;if(i.has("b64")&&"boolean"!=typeof(j=this.#d.b64))throw new g.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:k}=h;if("string"!=typeof k||!k)throw new g.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');(0,r.y)(k,a,"sign"),j?(c=(0,o.encode)(this.#g),d=(0,A.lF)(c)):(d=this.#g,c=""),this.#d?(e=(0,o.encode)(JSON.stringify(this.#d)),f=(0,A.lF)(e)):(e="",f=new Uint8Array);let l=(0,A.xW)(f,(0,A.lF)("."),d),n=await (0,q.l)(a,k),s=await J(k,n,l),t={signature:(0,o.encode)(s),payload:c};return this.#e&&(t.header=this.#e),this.#d&&(t.protected=e),t}}class L{#h;constructor(a){this.#h=new K(a)}setProtectedHeader(a){return this.#h.setProtectedHeader(a),this}async sign(a,b){let c=await this.#h.sign(a,b);if(void 0===c.payload)throw TypeError("use the flattened module for creating JWS with b64: false");return`${c.protected}.${c.payload}.${c.signature}`}}class M{#a;protectedHeader;unprotectedHeader;options;key;constructor(a,b,c){this.#a=a,this.key=b,this.options=c}setProtectedHeader(a){if(this.protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this.protectedHeader=a,this}setUnprotectedHeader(a){if(this.unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=a,this}addSignature(...a){return this.#a.addSignature(...a)}sign(...a){return this.#a.sign(...a)}done(){return this.#a}}class N{#g;#i=[];constructor(a){this.#g=a}addSignature(a,b){let c=new M(this,a,b);return this.#i.push(c),c}async sign(){if(!this.#i.length)throw new g.JWSInvalid("at least one signature must be added");let a={signatures:[],payload:""};for(let b=0;b<this.#i.length;b++){let c=this.#i[b],d=new K(this.#g);d.setProtectedHeader(c.protectedHeader),d.setUnprotectedHeader(c.unprotectedHeader);let{payload:e,...f}=await d.sign(c.key,c.options);if(0===b)a.payload=e;else if(a.payload!==e)throw new g.JWSInvalid("inconsistent use of JWS Unencoded Payload (RFC7797)");a.signatures.push(f)}return a}}class O{#d;#j;constructor(a={}){this.#j=new F.cE(a)}setIssuer(a){return this.#j.iss=a,this}setSubject(a){return this.#j.sub=a,this}setAudience(a){return this.#j.aud=a,this}setJti(a){return this.#j.jti=a,this}setNotBefore(a){return this.#j.nbf=a,this}setExpirationTime(a){return this.#j.exp=a,this}setIssuedAt(a){return this.#j.iat=a,this}setProtectedHeader(a){return this.#d=a,this}async sign(a,b){let c=new L(this.#j.data());if(c.setProtectedHeader(this.#d),Array.isArray(this.#d?.crit)&&this.#d.crit.includes("b64")&&!1===this.#d.b64)throw new g.JWTInvalid("JWTs MUST NOT use unencoded payload");return c.sign(a,b)}}var P=c(12781),Q=c(72892),R=c(81316),S=c(33999),T=c(98843);let U=(a,b)=>{if("string"!=typeof a||!a)throw new g.JWKInvalid(`${b} missing or invalid`)};async function V(a,b){let c,d;if((0,S.ll)(a))c=a;else if((0,R.P2)(a))c=await (0,T.JU)(a);else throw TypeError((0,x.X)(a,"CryptoKey","KeyObject","JSON Web Key"));if("sha256"!==(b??="sha256")&&"sha384"!==b&&"sha512"!==b)throw TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');switch(c.kty){case"AKP":U(c.alg,'"alg" (Algorithm) Parameter'),U(c.pub,'"pub" (Public key) Parameter'),d={alg:c.alg,kty:c.kty,pub:c.pub};break;case"EC":U(c.crv,'"crv" (Curve) Parameter'),U(c.x,'"x" (X Coordinate) Parameter'),U(c.y,'"y" (Y Coordinate) Parameter'),d={crv:c.crv,kty:c.kty,x:c.x,y:c.y};break;case"OKP":U(c.crv,'"crv" (Subtype of Key Pair) Parameter'),U(c.x,'"x" (Public Key) Parameter'),d={crv:c.crv,kty:c.kty,x:c.x};break;case"RSA":U(c.e,'"e" (Exponent) Parameter'),U(c.n,'"n" (Modulus) Parameter'),d={e:c.e,kty:c.kty,n:c.n};break;case"oct":U(c.k,'"k" (Key Value) Parameter'),d={k:c.k,kty:c.kty};break;default:throw new g.JOSENotSupported('"kty" (Key Type) Parameter missing or unsupported')}let e=(0,A.lF)(JSON.stringify(d));return(0,o.encode)(await (0,Q.b)(b,e))}async function W(a,b){b??="sha256";let c=await V(a,b);return`urn:ietf:params:oauth:jwk-thumbprint:sha-${b.slice(-3)}:${c}`}var X=c(92545);async function Y(a,b){let c={...a,...b?.header};if(!(0,h.G)(c.jwk))throw new g.JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a JSON object');let d=await (0,X.Og)({...c.jwk,ext:!0},c.alg);if(d instanceof Uint8Array||"public"!==d.type)throw new g.JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a public key');return d}function Z(a){return(0,h.G)(a)}class ${#k;#l=new WeakMap;constructor(a){if(!function(a){return a&&"object"==typeof a&&Array.isArray(a.keys)&&a.keys.every(Z)}(a))throw new g.JWKSInvalid("JSON Web Key Set malformed");this.#k=structuredClone(a)}jwks(){return this.#k}async getKey(a,b){let{alg:c,kid:d}={...a,...b?.header},e=function(a){switch("string"==typeof a&&a.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";case"ML":return"AKP";default:throw new g.JOSENotSupported('Unsupported "alg" value for a JSON Web Key Set')}}(c),f=this.#k.keys.filter(a=>{let b=e===a.kty;if(b&&"string"==typeof d&&(b=d===a.kid),b&&("string"==typeof a.alg||"AKP"===e)&&(b=c===a.alg),b&&"string"==typeof a.use&&(b="sig"===a.use),b&&Array.isArray(a.key_ops)&&(b=a.key_ops.includes("verify")),b)switch(c){case"ES256":b="P-256"===a.crv;break;case"ES384":b="P-384"===a.crv;break;case"ES512":b="P-521"===a.crv;break;case"Ed25519":case"EdDSA":b="Ed25519"===a.crv}return b}),{0:h,length:i}=f;if(0===i)throw new g.JWKSNoMatchingKey;if(1!==i){let a=new g.JWKSMultipleMatchingKeys,b=this.#l;throw a[Symbol.asyncIterator]=async function*(){for(let a of f)try{yield await _(b,a,c)}catch{}},a}return _(this.#l,h,c)}}async function _(a,b,c){let d=a.get(b)||a.set(b,{}).get(b);if(void 0===d[c]){let a=await (0,X.Og)({...b,ext:!0},c);if(a instanceof Uint8Array||"public"!==a.type)throw new g.JWKSInvalid("JSON Web Key Set members must be public keys");d[c]=a}return d[c]}function aa(a){let b=new $(a),c=async(a,c)=>b.getKey(a,c);return Object.defineProperties(c,{jwks:{value:()=>structuredClone(b.jwks()),enumerable:!1,configurable:!1,writable:!1}}),c}"undefined"!=typeof navigator&&navigator.userAgent?.startsWith?.("Mozilla/5.0 ")||(d="jose/v6.1.3");let ab=Symbol();async function ac(a,b,c,d=fetch){let e=await d(a,{method:"GET",signal:c,redirect:"manual",headers:b}).catch(a=>{if("TimeoutError"===a.name)throw new g.JWKSTimeout;throw a});if(200!==e.status)throw new g.JOSEError("Expected 200 OK from the JSON Web Key Set HTTP response");try{return await e.json()}catch{throw new g.JOSEError("Failed to parse the JSON Web Key Set HTTP response as JSON")}}let ad=Symbol();class ae{#m;#n;#o;#p;#q;#r;#s;#t;#u;#v;constructor(a,b){if(!(a instanceof URL))throw TypeError("url must be an instance of URL");this.#m=new URL(a.href),this.#n="number"==typeof b?.timeoutDuration?b?.timeoutDuration:5e3,this.#o="number"==typeof b?.cooldownDuration?b?.cooldownDuration:3e4,this.#p="number"==typeof b?.cacheMaxAge?b?.cacheMaxAge:6e5,this.#s=new Headers(b?.headers),d&&!this.#s.has("User-Agent")&&this.#s.set("User-Agent",d),this.#s.has("accept")||(this.#s.set("accept","application/json"),this.#s.append("accept","application/jwk-set+json")),this.#t=b?.[ab],b?.[ad]!==void 0&&(this.#v=b?.[ad],function(a,b){return!("object"!=typeof a||null===a||!("uat"in a)||"number"!=typeof a.uat||Date.now()-a.uat>=b)&&"jwks"in a&&!!(0,h.G)(a.jwks)&&!!Array.isArray(a.jwks.keys)&&!!Array.prototype.every.call(a.jwks.keys,h.G)}(b?.[ad],this.#p)&&(this.#q=this.#v.uat,this.#u=aa(this.#v.jwks)))}pendingFetch(){return!!this.#r}coolingDown(){return"number"==typeof this.#q&&Date.now()<this.#q+this.#o}fresh(){return"number"==typeof this.#q&&Date.now()<this.#q+this.#p}jwks(){return this.#u?.jwks()}async getKey(a,b){this.#u&&this.fresh()||await this.reload();try{return await this.#u(a,b)}catch(c){if(c instanceof g.JWKSNoMatchingKey&&!1===this.coolingDown())return await this.reload(),this.#u(a,b);throw c}}async reload(){this.#r&&("undefined"!=typeof WebSocketPair||"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||"undefined"!=typeof EdgeRuntime&&"vercel"===EdgeRuntime)&&(this.#r=void 0),this.#r||=ac(this.#m.href,this.#s,AbortSignal.timeout(this.#n),this.#t).then(a=>{this.#u=aa(a),this.#v&&(this.#v.uat=Date.now(),this.#v.jwks=a),this.#q=Date.now(),this.#r=void 0}).catch(a=>{throw this.#r=void 0,a}),await this.#r}}function af(a,b){let c=new ae(a,b),d=async(a,b)=>c.getKey(a,b);return Object.defineProperties(d,{coolingDown:{get:()=>c.coolingDown(),enumerable:!0,configurable:!1},fresh:{get:()=>c.fresh(),enumerable:!0,configurable:!1},reload:{value:()=>c.reload(),enumerable:!0,configurable:!1,writable:!1},reloading:{get:()=>c.pendingFetch(),enumerable:!0,configurable:!1},jwks:{value:()=>c.jwks(),enumerable:!0,configurable:!1,writable:!1}}),d}class ag{#j;constructor(a={}){this.#j=new F.cE(a)}encode(){let a=o.encode(JSON.stringify({alg:"none"})),b=o.encode(this.#j.data());return`${a}.${b}.`}setIssuer(a){return this.#j.iss=a,this}setSubject(a){return this.#j.sub=a,this}setAudience(a){return this.#j.aud=a,this}setJti(a){return this.#j.jti=a,this}setNotBefore(a){return this.#j.nbf=a,this}setExpirationTime(a){return this.#j.exp=a,this}setIssuedAt(a){return this.#j.iat=a,this}static decode(a,b){let c;if("string"!=typeof a)throw new g.JWTInvalid("Unsecured JWT must be a string");let{0:d,1:e,2:f,length:h}=a.split(".");if(3!==h||""!==f)throw new g.JWTInvalid("Invalid Unsecured JWT");try{if(c=JSON.parse(A.D0.decode(o.decode(d))),"none"!==c.alg)throw Error()}catch{throw new g.JWTInvalid("Invalid Unsecured JWT")}return{payload:(0,F.k6)(c,o.decode(e),b),header:c}}}function ah(a){let b;if("string"==typeof a){let c=a.split(".");(3===c.length||5===c.length)&&([b]=c)}else if("object"==typeof a&&a)if("protected"in a)b=a.protected;else throw TypeError("Token does not contain a Protected Header");try{if("string"!=typeof b||!b)throw Error();let a=JSON.parse(A.D0.decode((0,o.decode)(b)));if(!(0,h.G)(a))throw Error();return a}catch{throw TypeError("Invalid Token or Protected Header formatting")}}function ai(a){let b,c;if("string"!=typeof a)throw new g.JWTInvalid("JWTs must use Compact JWS serialization, JWT must be a string");let{1:d,length:e}=a.split(".");if(5===e)throw new g.JWTInvalid("Only JWTs using Compact JWS serialization can be decoded");if(3!==e)throw new g.JWTInvalid("Invalid JWT");if(!d)throw new g.JWTInvalid("JWTs must contain a payload");try{b=(0,o.decode)(d)}catch{throw new g.JWTInvalid("Failed to base64url decode the payload")}try{c=JSON.parse(A.D0.decode(b))}catch{throw new g.JWTInvalid("Failed to parse the decoded payload as JSON")}if(!(0,h.G)(c))throw new g.JWTInvalid("Invalid JWT Claims Set");return c}function aj(a){let b=a?.modulusLength??2048;if("number"!=typeof b||b<2048)throw new g.JOSENotSupported("Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used");return b}async function ak(a,b){let c,d;switch(a){case"PS256":case"PS384":case"PS512":c={name:"RSA-PSS",hash:`SHA-${a.slice(-3)}`,publicExponent:Uint8Array.of(1,0,1),modulusLength:aj(b)},d=["sign","verify"];break;case"RS256":case"RS384":case"RS512":c={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${a.slice(-3)}`,publicExponent:Uint8Array.of(1,0,1),modulusLength:aj(b)},d=["sign","verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":c={name:"RSA-OAEP",hash:`SHA-${parseInt(a.slice(-3),10)||1}`,publicExponent:Uint8Array.of(1,0,1),modulusLength:aj(b)},d=["decrypt","unwrapKey","encrypt","wrapKey"];break;case"ES256":c={name:"ECDSA",namedCurve:"P-256"},d=["sign","verify"];break;case"ES384":c={name:"ECDSA",namedCurve:"P-384"},d=["sign","verify"];break;case"ES512":c={name:"ECDSA",namedCurve:"P-521"},d=["sign","verify"];break;case"Ed25519":case"EdDSA":d=["sign","verify"],c={name:"Ed25519"};break;case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":d=["sign","verify"],c={name:a};break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{d=["deriveBits"];let a=b?.crv??"P-256";switch(a){case"P-256":case"P-384":case"P-521":c={name:"ECDH",namedCurve:a};break;case"X25519":c={name:"X25519"};break;default:throw new g.JOSENotSupported("Invalid or unsupported crv option provided, supported values are P-256, P-384, P-521, and X25519")}break}default:throw new g.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return crypto.subtle.generateKey(c,b?.extractable??!1,d)}async function al(a,b){let c,d,e;switch(a){case"HS256":case"HS384":case"HS512":c=parseInt(a.slice(-3),10),d={name:"HMAC",hash:`SHA-${c}`,length:c},e=["sign","verify"];break;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return c=parseInt(a.slice(-3),10),crypto.getRandomValues(new Uint8Array(c>>3));case"A128KW":case"A192KW":case"A256KW":d={name:"AES-KW",length:c=parseInt(a.slice(1,4),10)},e=["wrapKey","unwrapKey"];break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":case"A128GCM":case"A192GCM":case"A256GCM":d={name:"AES-GCM",length:c=parseInt(a.slice(1,4),10)},e=["encrypt","decrypt"];break;default:throw new g.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return crypto.subtle.generateKey(d,b?.extractable??!1,e)}let am="WebCryptoAPI"}};